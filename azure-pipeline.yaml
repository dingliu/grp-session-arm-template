name: $(Build.DefinitionName)_$(Date:yyyyMMdd)$(Rev:.r)

pool:
  vmImage: 'ubuntu-18.04'

trigger:
  paths:
    exclude:
      - local-demo/*
      - LICENSE
      - README.md

steps:
- task: ShellScript@2
  inputs:
    scriptPath: 'test.sh'
- task: Docker@2
  displayName: Login to Docker Hub
  inputs:
    command: login
    containerRegistry: dockerhub_dingliu
- task: Docker@2
  displayName: Build and Push
  inputs:
    command: buildAndPush
    repository: hello-app
    Dockerfile: 'hello-app/Dockerfile'
    buildContext: 'hello-app/'
    tags: $(Date:yyyyMMdd)$(Rev:.r)
